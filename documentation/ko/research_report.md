# 연구 보고서: 감정 인식을 위한 EEG 전극 제거 연구 (EEG Electrode Ablation Study)

## 1. 연구 목표 및 동기
본 연구의 주된 목표는 SEED-IV 데이터셋에 대한 엄격한 신경생리학적 및 계산적 분석을 수행하여, 다중 클래스 감정 인식에 가장 결정적인 EEG 전극과 뇌 영역을 식별하는 것입니다.

연구용 EEG 캡은 보통 62개 이상의 채널을 사용하지만, 이는 실생활 응용에는 부적합합니다. 본 연구는 높은 채널 수로 인해 발생하는 "차원의 저주(Curse of Dimensionality)" — 즉, 특징 수에 비해 샘플 수가 부족하여 발생하는 과적합 문제 — 를 해결하고, 성능을 유지하는 최소한의 최적 센서 세트를 찾는 데 집중합니다. 모델 불가지론적(Model-Agnostic) 해석 프레임워크를 통해 다음과 같은 목표를 달성하고자 합니다:
1.  **감정 뇌 지도화 (Mapping the Emotional Brain):** 4가지 감정(중립, 슬픔, 공포, 행복) 처리에 핵심적인 "핫스팟"을 자율적으로 식별합니다.
2.  **해석 가능성 검증:** 통계적 중요도(순열 중요도/통합 기울기)가 실제 기능적 뇌 해부학과 일치함을 증명합니다.
3.  **BCI 하드웨어 최적화:** 상용 몽타주(10-20 시스템, Emotiv EPOC, Muse)의 성능 트레이드오프를 결정하여 차세대 웨어러블 뇌-컴퓨터 인터페이스(BCI) 설계를 가이드합니다.

## 2. 데이터셋 및 특징 공학 (Feature Engineering)
*   **SEED-IV 데이터셋:** 상하이 교통대학교(SJTU)에서 제작한 벤치마크 데이터셋.
    *   **피험자:** 건강한 성인 15명 (성별 균형).
    *   **세션:** 피험자당 3개의 별도 세션 (날짜 간 변동성을 확보하기 위해 서로 다른 날 기록).
    *   **자극:** 세션당 24개의 영화 클립 (감정당 6개: 중립, 슬픔, 공포, 행복).
*   **미분 엔트로피 (Differential Entropy, DE) 특징:**
    *   일반적인 파워 스펙트럼 밀도(PSD)보다 감정 인식에서 더 안정적이고 변별력이 높은 것으로 입증된 지표입니다.
    *   **주파수 대역:** 델타(1-4Hz), 세타(4-8Hz), 알파(8-13Hz), 베타(13-30Hz), 감마(30-70Hz).
    *   **입력 차원:** 각 시행(Trial)을 하나의 샘플로 처리하며, `(62, 5, T)` 형태 — 62채널 × 5대역 × T 시간프레임, T=64로 제로 패딩.
*   **전처리:**
    *   **Z-점수 정규화 (Z-Score Normalization):** 제로 패딩 *전에* 세션 내 전체 프레임에서 통계량을 계산하여 수행 (`X = (X - μ) / σ`). 이는 EEG 신호의 비정상성과 센서 임피던스 차이를 완화하며, 패딩 영역이 진정한 영값(≈세션 평균)을 유지하도록 보장합니다.

## 3. 실험 아키텍처: SOGNN
**자기 조직화 그래프 신경망**(SOGNN; Li et al., 2021)을 사용합니다. SOGNN은 자기 조직화 그래프 합성곱을 통해 전극 간 동적 관계를 학습하며, 평면적 MLP 분류기와 달리 전극 간 공간적 의존성을 포착하여 어떤 전극(그래프 노드)이 분류를 주도하는지 분석하기에 적합합니다.

*   **전극별 특징 추출:** 3개의 Conv2d+MaxPool 블록이 각 전극의 `(5, T)` DE 특징을 독립적으로 처리하여 512차원 노드 특징 벡터를 생성합니다.
*   **자기 조직화 그래프 합성곱 (×3층):** 샘플별로 동적 인접 행렬 `A = softmax(tanh(HW) · tanh(HW)^T)`을 계산하고 top-k 이웃으로 희소화합니다. 그래프 합성곱: `H' = ReLU(A_sparse · H · W_gc)`. 출력: 노드당 64차원.
*   **분류:** 노드 특징을 평탄화(전극 정체성 보존)하여 선형 층 → 4 클래스. 총 ~130K 파라미터.
*   **규제:** 드롭아웃(0.1), 가중치 감쇠(1e-4), 레이블 스무딩(0.1), CosineAnnealingLR, 기울기 클리핑(max_norm=1.0), 검증 정확도 기반 조기 종료.

**해석 가능성 방법론.** 순열 중요도(PI)는 SOGNN을 블랙박스로 취급하여 완전한 모델 불가지론적 방법을 유지합니다. 통합 기울기(IG)는 SOGNN의 그래프 연산을 통해 기여도를 계산합니다. 재훈련 제거(Retrain ablation)는 전극을 그래프에서 완전히 제거하여 마스크 기반 결과를 검증합니다.

**원본 SOGNN 논문과의 차이점.** 피험자 간 LOSO 대신 피험자 내 평가(세션 1+2 학습, 세션 3 테스트)를 사용하며, 학습 AUC 임계값 대신 검증 정확도 기반 조기 종료를 적용하고, 소규모 피험자별 샘플(학습 48 / 테스트 24)에 대한 규제로 레이블 스무딩과 코사인 LR 스케줄링을 추가했습니다.

## 4. 실험 파이프라인 (Experimental Pipeline)

### 1단계: 하이퍼파라미터 최적화 및 앙상블
*   **하이퍼파라미터 탐색:** 세션 1과 2의 통합 데이터에 대해 **5-겹 그룹 교차 검증(5-Fold GroupKFold)**을 수행하여 그리드 탐색을 진행합니다. 시행(Trial) ID를 그룹으로 사용하여 시간적 누출(Temporal Leakage)을 방지합니다(모델이 학습과 검증 세트에서 동일한 영화 클립을 보지 않도록 함).
*   **멀티 시드 앙상블:** 모든 실험은 5개의 무작위 시드에 대해 반복됩니다. 최종 결과(정확도 및 중요도 점수)는 확률적인 가중치 초기화의 영향을 최소화하기 위해 이 앙상블 전체의 평균으로 계산됩니다.

### 2단계: 이중 방법 중요도 추출 (Dual-Method Importance)
공리적 및 통계적 관점을 모두 포괄하기 위해 두 가지 상호 보완적인 방법을 사용합니다:
1.  **순열 중요도 (Permutation Importance, PI):** 전역적, 모델 불가지론적 방법. 채널 $i$의 시간 데이터를 섞었을 때 발생하는 정확도 하락($\Delta Acc$)을 관찰합니다. 이는 선형 및 비선형 의존성을 모두 캡처합니다.
2.  **통합 기울기 (Integrated Gradients, IG):** 공리적 기여도 할당 방법. 기준점(0 입력)에서 실제 입력까지의 경로를 따라 기울기(Gradient)의 적분을 계산합니다. 이는 샘플 수준의 정밀한 기여도를 제공하며, 이를 평균하여 사용합니다.
*   **전체 순위 (Grand Ranking):** 15명의 피험자와 5개의 시드 전체에 대해 평균을 내어 최종 순위를 도출합니다.
*   **안정성 진단:** 서로 다른 시드 간의 **스피어만 순위 상관계수(Spearman Rho)**를 계산하여, 식별된 "감정 핫스팟"이 일관되고 신뢰할 수 있는지 검증합니다.

### 3단계: 체계적 제거 연구 (Systematic Ablation Study)
특정 신경과학적 가설을 검증하기 위해 센서를 체계적으로 비활성화합니다:
1.  **영역별 민감도:** 특정 영역(예: 전전두엽, 전두엽, 두정엽, 후두엽)을 비활성화합니다. "유지(Keep-Only, 충분성)"와 "제거(Remove-Only, 필요성)" 시나리오를 모두 테스트합니다.
2.  **반구 비대칭성:** 좌뇌와 우뇌의 예측력을 비교하여 감정의 측방화(Lateralization)를 조사합니다.
3.  **몽타주 실용성:** **Emotiv EPOC (14채널)** 또는 **Muse (4채널)**와 같은 상용 하드웨어 제약 조건에서의 정확도 하락을 평가합니다.
4.  **점진적 희소화 곡선 (Progressive Thinning Curves):** 남은 채널 수에 따른 정확도 변화를 그래프로 그립니다.
    *   **PI-유도 (PI-Guided):** 가장 덜 중요한 채널부터 제거.
    *   **무작위 (Random):** 20개의 무작위 순열에 대한 평균.
    두 곡선 사이의 간격은 우리가 식별한 전극들의 "정보 밀도"를 정량화합니다.

## 5. 통계적 검증 (Statistical Validation)
무작위 노이즈로부터 진정한 신경생리학적 효과를 구분하기 위해:
*   **윌콕슨 부호 순위 검정 (Wilcoxon Signed-Rank Test):** 서로 다른 설정(예: 전체 캡 vs 10-20 몽타주) 간의 15명 피험자 쌍별 정확도를 비교하는 비모수 검정입니다.
*   **홀름-본페로니 교정 (Holm-Bonferroni Correction):** 다중 비교를 수행하므로, 전체 오류율(FWER)을 제어하기 위해 p-값을 조정합니다. 이를 통해 보고된 유의성($p < 0.05$)이 진정으로 의미 있음을 보장합니다.

## 6. 기대 산출물 및 파급 효과
*   **지형적 중요도 맵:** 감정 처리에서 전두엽과 측두엽의 우세를 보여주는 고해상도 열 지도.
*   **제거 곡선:** 최소 센서 수에 대한 정량적 증거 (예: "12개 채널만으로 전체 캡 성능의 90% 달성").
*   **하드웨어 설계 가이드라인:** 정신 건강 모니터링 및 감성 컴퓨팅을 위한 저가형 휴대용 BCI 시스템 개발자를 위한 권장 "최소 감정 몽타주" 제안.