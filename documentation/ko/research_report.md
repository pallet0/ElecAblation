# 연구 보고서: 감정 인식을 위한 EEG 전극 제거 연구

## 1. 목표 (Objective)
본 연구의 목표는 감정 인식을 위한 가장 중요한 EEG 전극 및 뇌 영역을 식별하는 것입니다. **어텐션 기반 신경망(Attention-Based Neural Network)**을 사용하여 전극의 중요도를 자율적으로 순위 매기고, 높은 분류 정확도를 유지하기 위해 필요한 최소한의 센서 수를 결정하고자 합니다. 이는 웨어러블 뇌-컴퓨터 인터페이스(BCI) 개발에 직접적인 영향을 미칩니다.

## 2. 데이터셋 및 특징 (Dataset and Features)
*   **데이터셋:** SEED-IV (SJTU Emotion EEG Dataset).
    *   **피험자:** 15명.
    *   **세션:** 피험자당 3개 세션 (각기 다른 날짜에 기록됨).
    *   **감정:** 4개 클래스 (중립, 슬픔, 공포, 행복).
    *   **자극:** 세션당 24개의 영화 클립.
*   **특징:** 5개 주파수 대역(델타, 세타, 알파, 베타, 감마)에 걸쳐 62개 EEG 채널에서 추출한 미분 엔트로피(DE) 특징.
*   **전처리:** 세션 간 및 피험자 간 변동성을 처리하기 위해 세션별로 Z-점수 정규화(z-score normalization)를 수행했습니다.

## 3. 실험 아키텍처: MLPBaseline (Experimental Architecture: MLPBaseline)
본 연구는 감정 분류를 위한 견고한 기준점으로서 표준 다층 퍼셉트론(MLP)을 채택했습니다. 이 접근 방식은 모델 불가지론적인 특징 중요도 분석을 가능하게 합니다.
1.  **입력:** 310개의 특징(62 채널 × 5 대역)으로 구성된 펼쳐진 벡터.
2.  **은닉층 (Hidden Layers):** 배치 정규화(BatchNorm), ReLU 활성화 함수, 드롭아웃(Dropout)을 포함하는 두 개의 완전 연결 계층.
3.  **분류기 (Classifier):** 4개의 감정 클래스를 예측하는 최종 선형 계층.

## 4. 실험 파이프라인 (Experimental Pipeline)

### 1단계: 학습 전략
*   **하이퍼파라미터 탐색:** 최적의 드롭아웃 및 학습률을 찾기 위해 세션 1과 2의 통합 데이터에 대해 5-겹 계층별 교차 검증(5-fold Stratified Cross-Validation)을 수행합니다.
*   **멀티 시드 앙상블:** 각 피험자는 결과가 통계적으로 안정적이고 초기화 노이즈에 견고함을 보장하기 위해 여러 무작위 시드에 대해 학습됩니다.
*   **피험자별 학습:** 각 피험자는 개인화된 모델을 갖습니다.
    *   **학습 세트:** 세션 1 & 2.
    *   **테스트 세트:** 세션 3 (날짜 간 일반화 성능 평가).
    *   **정규화:** 모델이 특정 세션의 노이즈를 암기하는 것을 방지하기 위해 조기 종료(early stopping)를 사용합니다.

### 2단계: 채널 중요도 추출
모델 학습이 완료되면, 두 가지 사후 해석 방법을 사용하여 중요한 전극을 식별합니다:
1.  **순열 중요도 (Permutation Importance, PI):** 테스트 세트에서 한 번에 한 채널의 데이터를 체계적으로 섞은 후 정확도 하락폭을 측정합니다. 하락폭이 클수록 중요도가 높음을 의미합니다.
2.  **통합 기울기 (Integrated Gradients, IG):** 입력 특징에 대한 예측의 기울기를 계산하여 정밀한 기여도 맵을 제공합니다.
중요도 점수는 모든 피험자와 무작위 시드에 대해 평균을 내어 **전체 순위(Grand Ranking)**를 생성합니다.
*   **안정성 분석 (Stability Analysis):** 식별된 "핫스팟"의 일관성을 검증하기 위해 서로 다른 시드 간의 스피어만 순위 상관계수를 계산합니다.

### 3단계: 체계적 제거 연구 (Systematic Ablation Study)
다음 가설들을 테스트하기 위해 센서를 "제거(ablate)"(비활성화)합니다:
1.  **영역 필요성:** 어떤 엽(전두엽, 측두엽 등)을 제거했을 때 정확도에 가장 적은 영향을 미치는가?
2.  **반구 비대칭성:** 모델이 좌뇌 또는 우뇌만 사용했을 때 더 나은 성능을 보이는가?
3.  **몽타주 실용성:** 연구용 62채널 설정이 표준 10-20(19채널), Emotiv EPOC(14채널), Muse(4채널) 구성과 비교했을 때 어떠한가?
4.  **점진적 제거:** **중요도 기반 제거**(PI 순위에 따라 가장 덜 중요한 것부터 제거)와 **무작위 제거**를 비교합니다. 신뢰성을 보장하기 위해 모든 결과는 앙상블 모델들에 걸쳐 평균화됩니다.

## 5. 통계적 검증 (Statistical Validation)
결과의 견고성을 보장하기 위해 **윌콕슨 부호 순위 검정(Wilcoxon Signed-Rank Test)**을 사용하여 결과를 분석합니다. 다중 비교(예: 여러 하드웨어 몽타주 비교)가 수행되므로, "제1종 오류"(위양성)를 방지하기 위해 **홀름-본페로니 교정(Holm-Bonferroni Correction)**을 적용하여 보고된 성능 차이가 통계적으로 건전함을 보장합니다.

## 6. 기대 산출물 (Expected Deliverables)
*   **지형 열 지도 (Topographic Heatmaps):** "감정 뇌"가 가장 활발한 곳을 시각화 (PI 및 IG에서 도출).
*   **제거 곡선 (Ablation Curves):** 센서 수와 시스템 정확도 간의 트레이드오프를 정량화.
*   **하드웨어 권장사항:** 휴대용 감정 감지 헤드셋을 위한 최적의 최소 전극 세트 결정.
